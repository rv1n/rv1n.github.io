<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ—Ä—Ç—Ñ–µ–ª—å –∞–∫—Ü–∏–π MOEX</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìà –ü–æ—Ä—Ç—Ñ–µ–ª—å –∞–∫—Ü–∏–π –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –±–∏—Ä–∂–∏</h1>
            <div class="header-controls">
                <div class="last-update">
                    –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="last-update-time">-</span>
                    <span class="update-timer"> | –î–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: <span id="next-update-timer">-</span></span>
                </div>
                <button id="refresh-btn" class="btn btn-refresh" onclick="manualRefresh()" title="–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
        </header>

        <!-- –°–≤–æ–¥–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è -->
        <div class="portfolio-summary" id="portfolio-summary">
            <div class="summary-card">
                <div class="summary-label">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</div>
                <div class="summary-value" id="total-value">0 ‚ÇΩ</div>
            </div>
            <div class="summary-card">
                <div class="summary-label">–û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫</div>
                <div class="summary-value" id="total-pnl">0 ‚ÇΩ</div>
                <div class="summary-percent" id="total-pnl-percent">0%</div>
            </div>
        </div>

        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ -->
        <div class="add-form-container">
            <h2>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é</h2>
            <form id="add-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="ticker">–¢–∏–∫–µ—Ä *</label>
                        <input type="text" id="ticker" name="ticker" required placeholder="SBER" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="company_name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏</label>
                        <input type="text" id="company_name" name="company_name" placeholder="–°–±–µ—Ä–±–∞–Ω–∫">
                    </div>
                    <div class="form-group">
                        <label for="quantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ *</label>
                        <input type="number" id="quantity" name="quantity" required min="0.01" step="0.01" placeholder="10">
                    </div>
                    <div class="form-group">
                        <label for="average_buy_price">–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ *</label>
                        <input type="number" id="average_buy_price" name="average_buy_price" required min="0.01" step="0.01" placeholder="250.50">
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            </form>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è -->
        <div class="portfolio-table-container">
            <h2>–ú–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å</h2>
            <div id="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
            <div id="error-message" class="error-message" style="display: none;"></div>
            
            <table class="portfolio-table" id="portfolio-table" style="display: none;">
                <thead>
                    <tr>
                        <th>–¢–∏–∫–µ—Ä</th>
                        <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                        <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                        <th>–¶–µ–Ω–∞ —Å–µ–π—á–∞—Å</th>
                        <th>–ò–∑–º–µ–Ω–µ–Ω–∏–µ</th>
                        <th>–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏</th>
                        <th>P/L ‚ÇΩ</th>
                        <th>P/L %</th>
                        <th>–û–±—ä–µ–º</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="portfolio-tbody">
                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div id="edit-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é</h2>
            <form id="edit-form">
                <input type="hidden" id="edit-id">
                <div class="form-group">
                    <label for="edit-company_name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏</label>
                    <input type="text" id="edit-company_name" name="company_name">
                </div>
                <div class="form-group">
                    <label for="edit-quantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ *</label>
                    <input type="number" id="edit-quantity" name="quantity" required min="0.01" step="0.01">
                </div>
                <div class="form-group">
                    <label for="edit-average_buy_price">–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ *</label>
                    <input type="number" id="edit-average_buy_price" name="average_buy_price" required min="0.01" step="0.01">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" onclick="closeEditModal()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
