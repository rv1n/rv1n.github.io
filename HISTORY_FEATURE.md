# –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –û–ø–∏—Å–∞–Ω–∏–µ

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω –∞–∫—Ü–∏–π –∏–∑ –≤–∞—à–µ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚è∞ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:00 –ú–°–ö** - —Ü–µ–Ω—ã –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–∏–∫–µ—Ä–æ–≤ –∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- üìä –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è: —Ü–µ–Ω–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ (–∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∏ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ), –æ–±—ä—ë–º —Ç–æ—Ä–≥–æ–≤, –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è

### 2. –†—É—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- üìù –ö–Ω–æ–ø–∫–∞ **"–ó–∞–ø–∏—Å–∞—Ç—å —Ü–µ–Ω—ã —Å–µ–π—á–∞—Å"** - –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Ä—É—á–Ω—É—é —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ —Ü–µ–Ω—ã
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–Ω–∏–º–æ–∫ —Ü–µ–Ω –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏
- üìú –í–∫–ª–∞–¥–∫–∞ **"–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω"** - –Ω–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –î–≤–∞ —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:
  - **–í—Å–µ —Ç–∏–∫–µ—Ä—ã** - —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ –¥–∞—Ç–∞–º –∏—Å—Ç–æ—Ä–∏—è —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–∫–µ—Ä–∞
  - **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–∏–∫–µ—Ä** - —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π

### 4. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- **–ü–æ —Ç–∏–∫–µ—Ä—É** - –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–∏–∫–µ—Ä –∏–ª–∏ "–í—Å–µ —Ç–∏–∫–µ—Ä—ã"
- **–ü–æ –ø–µ—Ä–∏–æ–¥—É** - 7, 14, 30 –∏–ª–∏ 90 –¥–Ω–µ–π

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

### –¢–∞–±–ª–∏—Ü–∞ `price_history`
```sql
CREATE TABLE price_history (
    id INTEGER PRIMARY KEY,
    ticker VARCHAR(20) NOT NULL,
    company_name VARCHAR(200),
    price FLOAT NOT NULL,
    change FLOAT DEFAULT 0.0,
    change_percent FLOAT DEFAULT 0.0,
    volume INTEGER DEFAULT 0,
    logged_at DATETIME NOT NULL
);
```

## API Endpoints

### 1. GET `/api/price-history`
–ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ü–µ–Ω

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ticker` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–∏–∫–µ—Ä –∞–∫—Ü–∏–∏
- `days` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –∏—Å—Ç–æ—Ä–∏–∏

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
GET /api/price-history?ticker=SBER&days=30
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "success": true,
    "history": [
        {
            "id": 1,
            "ticker": "SBER",
            "company_name": "–°–±–µ—Ä–±–∞–Ω–∫",
            "price": 285.50,
            "change": 2.30,
            "change_percent": 0.81,
            "volume": 15000000,
            "logged_at": "2026-01-29 00:00:00"
        }
    ],
    "ticker": "SBER",
    "days": 30
}
```

### 2. POST `/api/log-prices-now`
–†—É—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
POST /api/log-prices-now
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "success": true,
    "message": "–¶–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω—ã"
}
```

## –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **APScheduler** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
```python
from apscheduler.schedulers.background import BackgroundScheduler
from apscheduler.triggers.cron import CronTrigger
import pytz

scheduler = BackgroundScheduler(timezone=pytz.timezone('Europe/Moscow'))

scheduler.add_job(
    func=price_logger.log_all_prices,
    trigger=CronTrigger(hour=0, minute=0, timezone='Europe/Moscow'),
    id='daily_price_logging',
    name='–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω –≤ 00:00 –ú–°–ö',
    replace_existing=True
)

scheduler.start()
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—â–µ–Ω. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:00 –ú–°–ö
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"üìú –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω"**
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–∫–µ—Ä–∞ –∏ –ø–µ—Ä–∏–æ–¥–∞
4. –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –†—É—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"üìú –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω"**
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üìù –ó–∞–ø–∏—Å–∞—Ç—å —Ü–µ–Ω—ã —Å–µ–π—á–∞—Å"**
3. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏
4. –ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§–∞–π–ª—ã
- `models/price_history.py` - –º–æ–¥–µ–ª—å –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
- `services/price_logger.py` - —Å–µ—Ä–≤–∏—Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω
- `app.py` - API endpoints –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
- `templates/index.html` - UI —Å –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–æ–π
- `static/css/style.css` - —Å—Ç–∏–ª–∏ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω
- `static/js/main.js` - JavaScript —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
APScheduler==3.10.4  # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
pytz==2023.3         # –†–∞–±–æ—Ç–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–æ–Ω–∞–º–∏
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –Ω–∞—á–Ω—ë—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Ç–∏–∫–µ—Ä–∞ –≤ –ø–æ—Ä—Ç—Ñ–µ–ª–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –≤ –¥–µ–Ω—å
- –ï—Å–ª–∏ —Ç–∏–∫–µ—Ä —É–¥–∞–ª—ë–Ω –∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è, –µ–≥–æ –∏—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –ë–î
- –ü–µ—Ä–≤–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –≤ 00:00 –ú–°–ö —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è
- –î–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ó–∞–ø–∏—Å–∞—Ç—å —Ü–µ–Ω—ã —Å–µ–π—á–∞—Å"

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
–í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω —Å –ø–æ–º–æ—â—å—é Chart.js:
- –õ–∏–Ω–µ–π–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ —Ü–µ–Ω
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∏–∫–µ—Ä–æ–≤
- –°–≤–µ—á–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ (OHLC)

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –≤ CSV/Excel –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö.

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
–î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Ü–µ–Ω.
