# –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π

## –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ–±–ª–∏–≥–∞—Ü–∏—è–º–∏ –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –∞–∫—Ü–∏—è–º. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è –æ–±–æ–∏—Ö —Ç–∏–ø–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –ù–æ–≤–æ–µ –ø–æ–ª–µ `instrument_type`

–î–æ–±–∞–≤–ª–µ–Ω–æ –≤–æ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `portfolio` - —Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤ –ø–æ—Ä—Ç—Ñ–µ–ª–µ
- `transactions` - —Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
- `price_history` - —Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω

–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
- `STOCK` - –ê–∫—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `BOND` - –û–±–ª–∏–≥–∞—Ü–∏—è

### –ú–∏–≥—Ä–∞—Ü–∏—è

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
python migrate_add_instrument_type.py
```

–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—Ç —Ç–∏–ø `STOCK`.

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ API

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–∫–µ—Ä–∞

**Endpoint:** `GET /api/validate-ticker/<ticker>`

**–ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä:**
- `instrument_type` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (`STOCK` –∏–ª–∏ `BOND`)

**–ü—Ä–∏–º–µ—Ä:**
```
GET /api/validate-ticker/SU26238RMFS4?instrument_type=BOND
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ –ø–æ—Ä—Ç—Ñ–µ–ª—å

**Endpoint:** `POST /api/portfolio`

**–ù–æ–≤–æ–µ –ø–æ–ª–µ:**
- `instrument_type` - —Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (`STOCK` –∏–ª–∏ `BOND`)

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "ticker": "SU26238RMFS4",
  "company_name": "–û–§–ó 26238",
  "instrument_type": "BOND",
  "quantity": 10,
  "average_buy_price": 950.50
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**Endpoint:** `POST /api/transactions`

**–ù–æ–≤–æ–µ –ø–æ–ª–µ:**
- `instrument_type` - —Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (`STOCK` –∏–ª–∏ `BOND`)

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "ticker": "SU26238RMFS4",
  "company_name": "–û–§–ó 26238",
  "operation_type": "–ü–æ–∫—É–ø–∫–∞",
  "instrument_type": "BOND",
  "price": 950.50,
  "quantity": 10,
  "date": "2026-02-06 10:00:00"
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è

**Endpoint:** `GET /api/portfolio`

**–ù–æ–≤–æ–µ –ø–æ–ª–µ –≤ –æ—Ç–≤–µ—Ç–µ:**
- `instrument_type` - —Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (–æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: "–ê–∫—Ü–∏—è" –∏–ª–∏ "–û–±–ª–∏–≥–∞—Ü–∏—è")

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ UI

### –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–∫—É–ø–∫–∏

–î–æ–±–∞–≤–ª–µ–Ω –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞:
- üìà –ê–∫—Ü–∏—è
- üìú –û–±–ª–∏–≥–∞—Ü–∏—è

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–∏–ø–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–∫–µ—Ä–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —Ä—ã–Ω–∫–µ MOEX.

### –¢–∞–±–ª–∏—Ü–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è

–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü **"–¢–∏–ø"** —Å –∏–∫–æ–Ω–∫–∞–º–∏:
- üìà –ê–∫—Ü–∏—è
- üìú –û–§–ó (–¥–ª—è –æ–±–ª–∏–≥–∞—Ü–∏–π)

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

–î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –Ω–∞–¥ —Ç–∞–±–ª–∏—Ü–µ–π –ø–æ—Ä—Ç—Ñ–µ–ª—è:
- –í—Å–µ —Ç–∏–ø—ã
- –ê–∫—Ü–∏–∏
- –û–±–ª–∏–≥–∞—Ü–∏–∏

### –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

–î–æ–±–∞–≤–ª–µ–Ω –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥ –ø–æ–ª–µ–º —Ç–∏–∫–µ—Ä–∞.

## –†–∞–±–æ—Ç–∞ —Å MOEX API

### –ê–∫—Ü–∏–∏

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è endpoint: `/iss/engines/stock/markets/shares/securities/{ticker}`

### –û–±–ª–∏–≥–∞—Ü–∏–∏

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è endpoint: `/iss/engines/stock/markets/bonds/securities/{ticker}`

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±–ª–∏–≥–∞—Ü–∏–∏

1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "+" (–ö—É–ø–∏—Ç—å)
2. –í—ã–±–µ—Ä–∏—Ç–µ "–û–±–ª–∏–≥–∞—Ü–∏—è" –≤ –ø–æ–ª–µ "–¢–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞"
3. –í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä –æ–±–ª–∏–≥–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `SU26238RMFS4`)
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
6. –ù–∞–∂–º–∏—Ç–µ "–ö—É–ø–∏—Ç—å"

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–ª—å–∫–æ –æ–±–ª–∏–≥–∞—Ü–∏–π

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ú–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å"
2. –í —Ñ–∏–ª—å—Ç—Ä–µ –Ω–∞–¥ —Ç–∞–±–ª–∏—Ü–µ–π –≤—ã–±–µ—Ä–∏—Ç–µ "–û–±–ª–∏–≥–∞—Ü–∏–∏"
3. –¢–∞–±–ª–∏—Ü–∞ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç —Ç–æ–ª—å–∫–æ –æ–±–ª–∏–≥–∞—Ü–∏–∏ –∏–∑ –≤–∞—à–µ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è

### –ü—Ä–æ–¥–∞–∂–∞ –æ–±–ª–∏–≥–∞—Ü–∏–∏

–†–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–æ–¥–∞–∂–µ –∞–∫—Ü–∏–π - –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "-" –Ω–∞–ø—Ä–æ—Ç–∏–≤ –Ω—É–∂–Ω–æ–π –æ–±–ª–∏–≥–∞—Ü–∏–∏.

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —Ç–∏–ø "–ê–∫—Ü–∏—è" –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π.

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

```python
class InstrumentType(enum.Enum):
    STOCK = "–ê–∫—Ü–∏—è"
    BOND = "–û–±–ª–∏–≥–∞—Ü–∏—è"
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

MOEX service –∫—ç—à–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—è –∫–ª—é—á `{ticker}_{instrument_type}`.

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω

Price logger –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π endpoint MOEX API.
